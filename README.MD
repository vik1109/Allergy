## Проект: Карта Аллергии

#### Постановка задачи:

Необходимо выделить топонимы и классифицировать текст на предмет указывает ли пользователь в своем сообщении о наличии у него аллергии в активной фазе и/или наличии в воздухе аллергенов. На основании предсказаний построить карту аллергии в России.

#### Описание:

На входе мы получаем выгрузку сообщений из специализированного сервиса. На этапе предобработки выгружаем данные в таблицу, выделяем топонимы и удаляем все строки без топонимов. Разбиванием полученные данные на выборки:  train(800), test(200), rest(остальные). В имеющихся данных имеем небольшой дисбаланс классов (примерно 0.6). Далее проводим парсинг токенов по правилам и готовим из  признаки. Парсим: части тела, симптомы, лекарства, аллергены, негативные и позитивные высказывания. Парсинг работает по словарям с использованием Yargy Parser. Обучаем модель и сохраняем, уточняем оптимальное значение вероятности, для максимизации качества модели. Далее уже готовой моделью предсказываем вероятности на выборке rest. Работать будем с признаками, которые включают в себя текст сообщения, их метрики лучше.

Проект разбит на логичные части с сохранение результатов на каждом из этапов:
- предбоработка сообщений
- парсинг топонимов
- парсинг: частей тела с проявлениями аллергии, симптомов, препаратов, аллергенов, позитивных и негативных высказываний в контексте аллергии
- разбиение на выборки train, test, rest
- обучения модели и сохранение модели
- загрузка и предсказание модели

Проект может быть использован полностью или отдельными блоками.

#### Стек:

Python (Pandas, NumPy, CatBoost, Yargy, Sklearn)

#### Метрики на обучении:

###### обучение без текста сообщения
- F1_Score 0.8148148148148148
- F1_Score на константной модели 0.7499999999999999
- precision_score 0.9166666666666666
- recall_score 0.7333333333333333
- ROC_AUC_SCORE 0.8871354166666667

###### обучение с текстом сообщения в признаках
- F1_Score 0.8444444444444444
- F1_Score на константной модели 0.7499999999999999
- precision_score 0.9047619047619048
- recall_score 0.7916666666666666
- ROC_AUC_SCORE 0.9113541666666667

#### Состав проекта:

- ../text/ - папка для хранения текстовых файлов
- ../DB/ - папка для хранения выгрузок
- ../model/ - папка с выгрузкой модели
- ../tmp/ - папка для хранения временных и тестовых данных
- msg_preprocessing.ru.py - предобработка выгрузки из сервиса https://vk.barkov.net/comments.aspx (превращаем выгрузку в таблицу, выделяем топонимы, сообщения без топонимов удаляем)
- msg_split.py - разбиваем cvs с сообщениями на train (800), test(200), rest(остальное)
- work_func.py - вспомогательные общие функции
- msg_parser.py - проведение парсинга в тексте интересующих нас токенов. Отбор частей тела, симптомов, лекарств, аллергенов, позитивных и негативных высказываний. Подготовка таблицы признаков.
- train.py - обучение и выгрузка модели на признаках без текста сообщений
- train_vs_text_feature.py - обучение и выгрузка на признаках с текстом сообщений
- predict.py - запуск модели в работу на признаках без текста сообщений
- predict_vs_text.py - запуск модели в работу на признаках с текстом сообщений
- results.ipynb - jupiter notebook демонстрирующий возможности работы
